#还没有复习 

# 数据校验

Q：哪些数据需要被校验
A：来自非信任边界的

## 数据校验方式：黑白名单

- 白名单规则：符合规则的数据才能通过
- 黑名单规则：符合规则的数据不能通过



## 禁止直接使用不可信任的数据

- 禁止把不可信任的数据拼接到 SQL 上导致 SQL 注入
- 禁止把不可信任的数据拼接到 XML 上导致各种网络脚本攻击
- 禁止把不可信任的数据记录到日志上
- 禁止把不可信任的数据拼接到命令行调用参数上（避免直接用 `Runtime.exec()`）


关于 SQL 注入和常见的 Web 攻击，这里不再赘述

重点聊下把不可信任的数据记录到日志上的危险性

如果把不可信任的数据记录到日志上，可能会导致

- 数据中存在恶意换行，导致一条日志看起来像多条日志。但预期之外的日志输出其实是攻击者伪造的
- 把未经过净化的数据直接记录在日志里，可能是违法的

所以需要注意，一个独立的日志系统应该提供参数的校验 api，供外部调用。而不能依赖于调用方在调用前能自觉编写校验、净化逻辑


## 禁止直接信任参数中的文件地址

如果应用提供了用参数指定文件地址并访问文件的功能

参数中的文件地址一定是虚拟地址

但即时传的是虚拟地址也可能存在安全问题

- 参数通过让文件地址参数包含 '.'，'..' 等访问到应用不想让外部访问到的文件

所以应该对参数中的文件地址进行检查，标准化，绝对路径化。

[【渗透测试】目录遍历漏洞](https://www.cnblogs.com/s0ky1xd/p/5823685.html)

