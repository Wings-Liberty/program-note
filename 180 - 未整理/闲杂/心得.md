找 bug 前需要了解业务

# 弄清楚 Bug 是什么

自测或测试人员任务某个功能存在 bug 时因为使用的**功能没有得到预期的结果**

主要分为这几类

系统类型，业务类型


## 系统类型 bug

Q：什么是系统类型 bug

A：访问页面 404，请求携带了有效 token 但还是返回无权访问，接口调不通，接口调失败，环境有问题，配置文件有问题


## 业务类型 bug

大致有以下两种

接口能调用，并且没有返回异常信息

- 增删改查数据
- 启动暂停任务
- 上传下载数据
- 定时任务
- 事务控制不当导致数据不一致
- 调用第三方调不通，超时

接口能调用，但返回异常信息

- 接口报错，执行结果没有被持久化
- 接口报错，但事务控制不当导致数据不一致，部分结果被持久化，部分结果没有被保存

## 出现 bug 的原因

- 基础不牢，代码编写错误。不合法的类型转换，没有判空，没处理异常...
- 业务不熟，一个接口要执行 a, b, c 三大步，结果少执行一步，多执行一步，一步执行错了
- 各种容错 case 考虑不周全，输入，或数据库状态不是理想情况，代码有没有容错

比如 A 功能要调用 B 功能保存的数据，结果执行时 B 删除了数据，**A 理所当然地认为 B 里的数据还在**，所以没有判空，没有处理异常


# 定位 bug 的方式


首先要知道哪一步出错了，然后定位到哪行代码出错了

查看错误日志，查看接口返回结果

## 验证疑似 bug 的方法是否真的有问题

定位 bug 时，因为代码在线上运行，所以有时可能猜测某个方法有问题，但不能确定

判断方法是否有问题本质上就是

- 入口：判断方法入参是否有问题
- 出口：方法执行结果是否是期望值

方法执行结果是否是期望值，通常可以通过方法返回结果或数据库状态来验证。如果方法是个接口直接访问就好，如果是静态方法就写单元测试测

但是有时可能方法本身没有问题，而是方式的入参不是期望范围，常用手段是添加 `log.info` 打印入参。但是经常会处于本地没有运行项目的条件，需要替包到服务器上且时间成本比较大的情况，导致定位 bug 时间比较长

# 修改 bug 的方式

有些 bug 改不了是因为设计缺陷，导致修改成本非常高，而不是不能改

# 避免 bug 的方式

## 避免自己写出 bug


## 避免被人调自己的代码导致 bug

很简单，写清楚注释，方法入口做严格的参数校验，包括但不仅限于判空，判正则，判业务合法性（比如要求时间参数必须在指定范围内，int / String 标志位必须在指定范围内）