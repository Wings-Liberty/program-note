#还没有复习 

[[../../021 - 离线网页备份文件夹/一些关于flowable里组件的作用和生命周期的提问和ChatGPT.35的回答.html|一些关于flowable里组件的作用和生命周期的提问和ChatGPT.35的回答]]

- FlowableEngineAgenda：Flowable只会创建一个FlowableEngineAgenda对象。它维护一个栈，栈里都是将要执行的 Runable

栈里的 Runable 都来自于 Command 或是一个 AbstractOperation 对象

- Command：命令类。是客户端对 flowable 服务端下的命令，比如启动一个流程，发出一个信号，创建一个审批动作，执行一个 JavaDelegate。如果 tomcat 处理的是一个个请求，flowable 处理的就是一个个 commmand

- CommandInvoker：执行命令的类。相当于 tomcat 的事件循环，其会不断用 FlowableEngineAgenda 弹栈并执行命令

- ContinueProcessOperation：驱动流程实例流转的'操作"对象。获取到指定执行实例当前的 FlowElement 对象后执行它 -- FlowElement 分为两大类：顺序流，节点。如果是顺序流，执行完顺序流的逻辑后最终还是会调用 FlowableEngineAgenda 执行节点；如果是节点，执行完节点的逻辑后最终还是会调用 FlowableEngineAgenda 执行顺序流，直到节点没有出口顺序流。启动流程的时候也是创建一个 StartProcessInstanceCmd 对象丢到 CommandExecutor 里，CommandExecutor 的拦截器链中的 CommandInvoker 会把 StartProcessInstanceCmd 最终会创建一个 ContinueProcessOperation 丢给 FlowableEngineAgenda 执行 `planOperation(new ContinueProcessOperation())`


Q：flowable里ActivityBehavior和AbstractOperation是什么关系，有什么区别？

A：

在Flowable流程引擎中，ActivityBehavior和AbstractOperation是两个不同的概念，它们有区别但也有一些联系。

首先，ActivityBehavior是流程节点的行为，每个节点都可以指定相应的ActivityBehavior实现类，用于定制节点的具体执行过程。而AbstractOperation是命令操作的基类，负责封装各种不同类型的操作逻辑，例如创建流程实例、完成任务、保存表单等。这两个概念在流程引擎中分别承担着不同的角色。

区别方面，ActivityBehavior主要关注流程节点的执行逻辑，在节点执行时会被调用。Node里有个属性behavior，主要用来存 ActivityBehavior 对象，当调度到该节点时，便会根据behavior 执行其act 方法逻辑。而AbstractOperation则更加抽象，关注通用命令操作，无法直接与流程节点进行关联。虽然它们的实现方式不同，但实际上，ActivityBehavior往往会调用或依赖于AbstractOperation等底层API执行具体的操作。

另外，需要注意的是，他们都可以自行扩展。开发者可以通过继承AbstractOperation类重写execute()方法，从而实现自定义的逻辑处理；而针对节点的业务逻辑，则可以使用自定义的ActivityBehavior实现类，覆盖对应的方法。通过这种方式可以灵活地扩展Flowable的功能，面对不同的业务需求提供个性化的解决方案。

总之，ActivityBehavior和AbstractOperation是Flowable框架中的两个核心概念，分别用来处理流程节点和命令操作等场景。需要根据具体情况，选择合适的类或接口来进行开发实现。

