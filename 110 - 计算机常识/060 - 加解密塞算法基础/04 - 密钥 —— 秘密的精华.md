#还没有复习 

## 密钥的价值

- 如果窃听者能够获得用于解密的密钥， 则密文的机密性就无法得到保证

- 如果攻击者能够获得用于数字签名的私钥， 就可以发动伪装攻击

密钥是发送双方身份的象征，也能用于加解密明文和密文


机密性不应该依赖于密码算法本身， 而是应该依赖于妥善保管的密钥。 这是密码学的常识

所以，密钥和明文是等价的

密钥就是一个巨大的数字或一串长的二进制比特序列。密钥空间越大，进行暴力破解就越困难。 密钥空间的大小是由密钥长度决定


## 各种用途的密钥

| 密钥分类                               | 密钥用途                                                               |
| -------------------------------------- | ---------------------------------------------------------------------- |
| 对称密钥和非对称密钥                   |                                                                        |
| 消息认证码的密钥与数字签名的密钥       | “持有合法的密钥” 就是发送者和接收者合法身份的证明                      |
| 会话密钥和主密钥                       | 每次通信只能使用一次的密钥称为会话密钥，一直被重复使用的密钥称为主密钥 |
| 用于加密内容的密钥与用于加密密钥的密钥 | CEK ( 内容加密密钥 ) ，KEK ( 密钥加密密钥 ）                           | 


## 内容加密密钥 CEK 和 密钥加密密钥 KEK

会话密钥都是被作为 CEK 使用，主密钥则作为 KEK 使用

KEK 可以减少需要保管的密钥数量，比如被 KEK 加密的会话密钥通常不需要被密钥中心长久保存，会话密钥仅作为临时密钥使用

再比如，假设有 100 万个文件需要被加解密，每个文件有一个 CEK 密钥，用户就需要管理 100 万个密钥。如果这 100 万个 CEK 被当作文件，并被 KEK 加解密，用户只需要小心保管好 KEK 不被窃取即可

从管理 100 万个 CEK 不被窃取到管理 1 个 KEK 不被窃取


## 密钥的生成

密钥的生成有两种：随机数生成器生成，用口令生成密钥

用口令生成密钥通常用于人为设置某个账号的电子密码，这种人为设置的口令也叫 password，而口令通常会被加密再保存到 DB 中

口令密钥的生成通常需要把 ( 口令, 盐 ) 输入到单向散列函数或加密算法中得到散列值或密钥

这种方法称为 “基于口令的密码”


> [!NOTE] 盐是随机数，用于防止字典攻击


## 字典攻击和盐的作用

如果没有盐，用口令生成密钥的过程就变成了仅仅把 password 输入到单项散列函数


> [!NOTE] 为什么加盐就能提高安全性？
> [为什么要在密码里加点“盐”](https://www.cnblogs.com/zhangmingcheng/p/7356607.html)
> 
> [中国维基百科 - 盐 (密码学)](https://zh.m.wikipedia.org/zh-hans/%E7%9B%90_(%E5%AF%86%E7%A0%81%E5%AD%A6))

盐可以被公开，但不会特意公开，只是不需要额外保护而已，通常盐值会和散列后的密码保存在一块。加盐之后，就不存在弱密码了。如果用彩虹表破解，需要为每个盐值计算一个彩虹表，和暴力破解几乎没差别

> [!NOTE] 用生日，身份证，名字作为口令是弱强度口令的表现，即使加盐也救不了把这些当密码的人


## 随机数生成器

随机数生成器产生的随机数必须具有：随机性，不可预测性，不可重现性

所以随机数产生的依据必须也是随机的，比如今天的天气，温度，湿度

这些被称为随机数生成器的 "内部状态“

软件实现的随机数生成器会接收 ”种子“ 作为初始 ”内部状态“ 来产生随机数

”种子“ 可以使用户随机定义的数字。”种子“ 可以经过加密算法，单向散列函数，线性同余法等计算产生一个随机数。每产生一个随机数后就改变 ”种子“ 使得下一个随机数变得不可预测


> [!NOTE] 种子的来源
> 种子用于产生随机数，但又希望种子的值是随机的。这和密钥不同，密钥可用随机数表示，但种子值需要人为随意赋值或收集周围环境的随机信息产生
